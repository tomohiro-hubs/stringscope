
<!DOCTYPE html>
<html>
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/exceljs/4.4.0/exceljs.min.js"></script>
</head>
<body>
<script>
    async function runDebug() {
        try {
            const response = await fetch('debug_target.xlsx');
            const buffer = await response.arrayBuffer();
            const workbook = new ExcelJS.Workbook();
            await workbook.xlsx.load(buffer);
            
            const sheet = workbook.getWorksheet(1);
            console.log("SHEET_LOADED");
            
            // Check Row 125 as user requested
            const r = 125;
            const row = sheet.getRow(r);
            const name = row.getCell(3).text;
            const timeVal = row.getCell(4).value;
            const pv8Val = row.getCell(12).value;
            
            console.log(`ROW_125_INFO: Name="${name}", Time="${timeVal}", PV8="${pv8Val}", PV8_Type="${typeof pv8Val}"`);
            
            if (typeof pv8Val === 'object') {
                console.log("PV8_IS_OBJECT: " + JSON.stringify(pv8Val));
            }

            // Time parsing check
            let dateStr = "";
            if (timeVal instanceof Date) {
                dateStr = timeVal.toISOString(); // UTC
                const hours = timeVal.getUTCHours();
                console.log(`TIME_CHECK: Hours(UTC)=${hours}`);
            } else {
                console.log(`TIME_CHECK: Not a Date object`);
            }

        } catch (e) {
            console.error(e);
        }
    }
    runDebug();
</script>
</body>
</html>

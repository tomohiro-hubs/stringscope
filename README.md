# PCS ストリング電流 0A検知ツール

PCS（パワーコンディショナ）のログデータ（Excel/xlsx形式）から、指定した時間帯におけるストリング電流の0A（異常値）を検出し、結合・ハイライト表示する静的Webアプリケーションです。

## 機能

- **Excelファイル結合**: 複数のxlsxファイルを読み込み、データを1つのシートに統合します。
- **PCS識別**: データ内の設備名称からPCS番号を抽出し、マスタデータと照合します。
- **異常検知**: マスタデータに基づく回路数（7または8）に応じて、指定時間帯内の0A（電流ゼロ）箇所を赤くハイライトします。
- **完全クライアントサイド**: サーバーへのデータ送信は一切行わず、ブラウザ内で完結して処理を行います（セキュリティ・プライバシー配慮）。

## 使用方法

1. **時間帯の設定**: 解析対象とする開始時間と終了時間を入力します（例: 09:00 ～ 18:00）。
2. **ファイルの選択**: 解析したいログファイル（.xlsx）をドラッグ＆ドロップまたは選択します（複数可）。
3. **実行**: 「実行する」ボタンを押すと処理が開始されます。
4. **ダウンロード**: 処理が完了すると、結果ファイルがダウンロード可能になります。

## 技術仕様

- **Framework**: React + Vite
- **Styling**: Tailwind CSS
- **Excel Processing**: ExcelJS (Browser build)
- **Data Source**: `public/data.json` (PCSマスタデータ)

## データ仕様

### 入力データ (ログファイル)
- 形式: .xlsx
- 構造:
  - 1-3行目: メタ情報（ヘッダの一部として出力に保持）
  - 4行目: ヘッダ行
  - 5行目以降: データ行
  - C列: 設備名称（PCS番号抽出元）
  - D列: タイムスタンプ
  - E-L列: PV1～PV8 電流値

### マスタデータ
- `public/data.json` に配置。
- `id`, `pcsKey` (例: "PCS 1-1-1"), `circuitCount` (7 or 8) を定義。

## 開発者向け

### インストール
```bash
npm install
```

### 開発サーバー起動
```bash
npm run dev
```

### ビルド
```bash
npm run build
```

## 注意事項
- ブラウザのメモリ制限に依存するため、数百MBを超える巨大なファイルの処理には時間がかかる、またはクラッシュする可能性があります。
- データ不整合（マスタにないPCSなど）がある場合は、警告として表示されます。
